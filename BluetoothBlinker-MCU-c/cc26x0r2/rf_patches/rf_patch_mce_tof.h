/******************************************************************************
*  Filename:       rf_patch_mce_tof.h
*  Revised:        $Date: 2019-08-23 12:24:13 +0200 (Fri, 23 Aug 2019) $
*  Revision:       $Revision: 19131 $
*
*  Description: RF core patch for supporting time-of-flight radio measurements in CC2640R2F
*
*  Copyright (c) 2015-2019, Texas Instruments Incorporated
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*  1) Redistributions of source code must retain the above copyright notice,
*     this list of conditions and the following disclaimer.
*
*  2) Redistributions in binary form must reproduce the above copyright notice,
*     this list of conditions and the following disclaimer in the documentation
*     and/or other materials provided with the distribution.
*
*  3) Neither the name of the ORGANIZATION nor the names of its contributors may
*     be used to endorse or promote products derived from this software without
*     specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
*  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
*  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
*  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
*  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
*  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
*  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
*  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
*  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
*  POSSIBILITY OF SUCH DAMAGE.
*
******************************************************************************/

#ifndef _RF_PATCH_MCE_TOF_H
#define _RF_PATCH_MCE_TOF_H

#include <stdint.h>
#include "../inc/hw_types.h"

#ifndef MCE_PATCH_TYPE
#define MCE_PATCH_TYPE static const uint32_t
#endif

#ifndef PATCH_FUN_SPEC
#define PATCH_FUN_SPEC static inline
#endif

#ifndef RFC_MCERAM_BASE
#define RFC_MCERAM_BASE 0x21008000
#endif

#ifndef MCE_PATCH_MODE
#define MCE_PATCH_MODE 0
#endif

MCE_PATCH_TYPE patchTofMce[512] = { 
   0x00036053,
   0x00f1000f,
   0x00000000,
   0x000c8000,
   0x00000000,
   0x0c650000,
   0x80000000,
   0x00008012,
   0x0b1e0000,
   0x00000590,
   0x00000000,
   0x00ff0000,
   0x001f0000,
   0x00463737,
   0xfe6b2840,
   0xdeade8ca,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x00000000,
   0x07fc0011,
   0x6fdd2fea,
   0x0fd00ff0,
   0x00030fd0,
   0x007ff80f,
   0x005a001f,
   0x00008010,
   0x08000190,
   0xc1024000,
   0xc0013162,
   0x1e008150,
   0x1a10404b,
   0x1020604d,
   0x6f131a10,
   0x16116e23,
   0x684d1612,
   0xc0307000,
   0x722067f4,
   0xa32d7248,
   0x73057303,
   0x73047203,
   0x72047306,
   0x72767376,
   0x8001c7c0,
   0x90010001,
   0x08019010,
   0x720c9001,
   0x720e720d,
   0x7100b0c0,
   0xb0f0a0c0,
   0x81327218,
   0x39521020,
   0x00200670,
   0x11011630,
   0x6c011401,
   0x60936088,
   0x616460b1,
   0x6088621e,
   0x60886088,
   0x60936088,
   0x616460b1,
   0x6088621e,
   0x60886088,
   0x608a608c,
   0x608e1220,
   0x121067de,
   0x00108181,
   0xb0709180,
   0xc011606a,
   0xc560c282,
   0x6f131820,
   0x16116e23,
   0x68971612,
   0x97e07c00,
   0x8131c022,
   0x18123981,
   0x9862d040,
   0x1e0167f4,
   0x7c10408c,
   0x7be097e0,
   0x7bf09350,
   0x7c209300,
   0xb33092d0,
   0x6705608c,
   0xc07067a3,
   0xb5a091c0,
   0xb764671f,
   0x673db203,
   0x8724a5a0,
   0x87349454,
   0x8ad49464,
   0x86149434,
   0xb0c09444,
   0xb116b0c5,
   0x7b50b0f0,
   0x90602a00,
   0x1e0ec0f1,
   0x161140ce,
   0xb7629781,
   0xb041c037,
   0x7311a760,
   0x94348724,
   0x94448734,
   0x86138ad4,
   0xb110b0e0,
   0x67f4c050,
   0xc031b0f5,
   0x7100a760,
   0xb760b073,
   0x80907388,
   0x45592200,
   0x226280b2,
   0x22024509,
   0x943440fb,
   0xb0639443,
   0xa760b204,
   0x85708961,
   0x18013d80,
   0xa0e09551,
   0xb0e67311,
   0x225060de,
   0x821040de,
   0x45062200,
   0x40de220f,
   0x67c3100f,
   0x60deb053,
   0x67d3100f,
   0xa76360de,
   0x936cb207,
   0xa0c58960,
   0xb0c1720e,
   0x7100b0f1,
   0xb0f19787,
   0x39108ab0,
   0x1a103120,
   0xb32d7100,
   0xb0749780,
   0x93b0c0d0,
   0x95e18791,
   0x7100b0f1,
   0xb88ab88b,
   0xc210b078,
   0xa2029780,
   0xb0f1b205,
   0xa32d7100,
   0x7276b06e,
   0xc060a0c1,
   0x8a6367f4,
   0x14238a82,
   0x8a928a74,
   0xcff21424,
   0x31430424,
   0x00343143,
   0xc8f09604,
   0xb205693e,
   0xa0e0b110,
   0xa0e6b116,
   0x7276b764,
   0xa003a5a0,
   0xc7c0a002,
   0x72039010,
   0x73057204,
   0x67de7306,
   0xb205a202,
   0x1e028212,
   0x72204550,
   0x67f4c070,
   0xb205608c,
   0x8792a202,
   0x9862d080,
   0x720e67f4,
   0x7311720c,
   0x6140730f,
   0x66ebc00f,
   0xc07067a3,
   0x671f91c0,
   0xb064b013,
   0x22008ab0,
   0xb0e0416f,
   0xb0c5b0c0,
   0xb110b0f1,
   0xb7627276,
   0x1e0ec0e1,
   0x1611417a,
   0xc0379781,
   0xb202b041,
   0x67f4c090,
   0x84498438,
   0x84618450,
   0x94419430,
   0xa760c031,
   0x7100b0f5,
   0xb760b073,
   0x80907388,
   0x46152200,
   0x226280b2,
   0x220245b1,
   0x225045a0,
   0x82104186,
   0x45ae2200,
   0x4186220f,
   0x67c3100f,
   0x6186b053,
   0x94499438,
   0xb204b063,
   0x8570a760,
   0x89613d80,
   0x95511801,
   0x7311a0e0,
   0x6186b0e6,
   0x67d3100f,
   0xb7636186,
   0xb889b207,
   0xa0c5936c,
   0x7311720e,
   0xb0f1b0c1,
   0xb0417100,
   0xb0f19787,
   0x39108ab0,
   0x1a103120,
   0xb32d7100,
   0xb0749780,
   0x93b0c0d0,
   0x7100b0f1,
   0xc210b078,
   0xa2029780,
   0x7100b0f1,
   0xb06ea32d,
   0xa0c1a760,
   0xc00067e5,
   0x140187e1,
   0x14018170,
   0x82309781,
   0x1c0189a1,
   0xc0a049e2,
   0x618667f4,
   0x8724b184,
   0x87349454,
   0x8ad49464,
   0x86149434,
   0xb0f69444,
   0x7100b0c6,
   0xa0c6b0f6,
   0x22008090,
   0xb0124615,
   0x82007276,
   0x26302a20,
   0x673d9200,
   0x8601c070,
   0x31828942,
   0xc3103d82,
   0xb0646a00,
   0x67deb0f1,
   0x8212b205,
   0x46031e02,
   0x7276b764,
   0xa002a003,
   0x9010c7c0,
   0x72047203,
   0x73067305,
   0x67f4c0b0,
   0xc0c0608c,
   0xb20567f4,
   0x720c720e,
   0x730f7311,
   0x62037276,
   0x67a366eb,
   0xc070c00b,
   0x671f91c0,
   0x67f4c0d0,
   0x725fb764,
   0x8ab0b013,
   0x422f2200,
   0xb110b0e0,
   0x84386235,
   0x84508449,
   0x94308461,
   0xb0f09441,
   0xb0e0b064,
   0xb0c5b0c0,
   0x1e1bb110,
   0x72764240,
   0x72acb762,
   0xc070c137,
   0x42461e0e,
   0xc0b71610,
   0xb2029780,
   0xb05367c3,
   0xc031b0f5,
   0x7100a760,
   0xb760b073,
   0x80b27388,
   0x46772262,
   0x46642202,
   0x22008090,
   0x225046e8,
   0x8210424a,
   0x46742200,
   0x424a220f,
   0x67c3100f,
   0x624ab053,
   0x94499438,
   0x8961b063,
   0x3d808570,
   0x95511801,
   0xa0e0a760,
   0x7311b0e6,
   0x93607b60,
   0x624ab204,
   0x67d3100f,
   0x1e1b624a,
   0xa765428a,
   0xb763b766,
   0xb1856291,
   0x8a808a63,
   0x8a901403,
   0x14048a74,
   0x31433143,
   0x96040034,
   0x62be6705,
   0xb207a763,
   0x8791b184,
   0x727695e1,
   0x978762b1,
   0x936cb889,
   0x720ea0c5,
   0xb0f1b0c1,
   0x8ab0b0f1,
   0x31203910,
   0x89a11a10,
   0x710095f1,
   0x9780b32d,
   0xc0d0b074,
   0xb0f193b0,
   0xb0787100,
   0x9780c210,
   0x7100b0f1,
   0xb06ea32d,
   0xa0c1a760,
   0x8a63627d,
   0x14038a80,
   0x8a748a90,
   0x31431404,
   0x00343143,
   0xc8f09604,
   0x62d46abc,
   0x8724bac0,
   0x94349454,
   0x94648734,
   0x8ad89444,
   0xc01b8619,
   0xb064b0f0,
   0xb0c0b0e0,
   0xb0f0b0c5,
   0x7311b064,
   0x7b8067c3,
   0x624a9360,
   0xb764b205,
   0xa5a07276,
   0xa002a003,
   0x9010c7c0,
   0x72047203,
   0x73067305,
   0xa20267de,
   0x8212b205,
   0x46e11e02,
   0x608c7220,
   0xa202b205,
   0x845462d5,
   0x87d397c4,
   0x97c48464,
   0x140387d0,
   0x1803c100,
   0x97c48434,
   0x844487d2,
   0x87d097c4,
   0xc1001402,
   0x31121802,
   0x31833113,
   0x39823182,
   0x95720032,
   0x87247000,
   0x87d397c4,
   0x97c48734,
   0x140387d0,
   0x1803c100,
   0x97c48ad4,
   0x861487d2,
   0x87d097c4,
   0xc1001402,
   0x31121802,
   0x31833113,
   0x39823182,
   0x95720032,
   0x82127000,
   0x431f2212,
   0xb016b006,
   0xb002b012,
   0xb014b004,
   0x90307b40,
   0x7b509050,
   0x90609040,
   0x7310730f,
   0xb1077311,
   0x7100b0d7,
   0xa0d7b072,
   0x6b37d680,
   0xb05367c3,
   0x93b0c0b0,
   0xc0e07000,
   0xbac067f4,
   0x9780c080,
   0xb760b761,
   0xb0f1b0c1,
   0x72767100,
   0xb0f1a0c1,
   0x72297b37,
   0x8ab29485,
   0xb003c0f3,
   0x8140b013,
   0x81609290,
   0xb0d09490,
   0x7100b100,
   0x94908450,
   0xb1009293,
   0x84607100,
   0xb1009490,
   0x84307100,
   0x92939490,
   0x7100b100,
   0x94908440,
   0x6d71b100,
   0x9ae16d71,
   0x39121617,
   0x47721e02,
   0x63857100,
   0x1e023942,
   0xc0714777,
   0x1a126379,
   0x1020c0f1,
   0x71008ae3,
   0x94939291,
   0x6d73b100,
   0x9ae16d73,
   0x71001617,
   0x72496b7d,
   0xc0409486,
   0xb7619780,
   0xb0c1b760,
   0xa0d0b0f1,
   0x7100b100,
   0xa0c17276,
   0x85a0b0f1,
   0x43981e10,
   0x639fb205,
   0xb766a765,
   0x8200b763,
   0x26202a30,
   0xc0909200,
   0xaac06ba0,
   0x72207000,
   0xc0f07218,
   0x722c9290,
   0x92a1c1f1,
   0x7b26c015,
   0x7b6c7b37,
   0x22008ab0,
   0x7ba043b6,
   0x7bb09400,
   0x63b89420,
   0x94007bc0,
   0x9486aac0,
   0x91b0c100,
   0x398e813e,
   0x1e0ec01d,
   0xc03d43c2,
   0x724e7000,
   0x7b92724f,
   0x9362b053,
   0x6bc9c3b0,
   0x9880c030,
   0x94e08890,
   0x94f188a1,
   0x93607b70,
   0x98817000,
   0x88a48893,
   0x3d633133,
   0x3d643134,
   0x94f494e3,
   0x7000b053,
   0x720d720e,
   0x7311720c,
   0x730f7310,
   0xc0007000,
   0x8a63c082,
   0x18348a74,
   0x4fef1c24,
   0x4bf11442,
   0x10d063f3,
   0xc00063f3,
   0x700018d0,
   0x88409850,
   0x47f52200,
   0x7000b830,
   0x00000000,
   0x56781234,
   0x59123232
};

PATCH_FUN_SPEC void rf_patch_mce_tof(void)
{
#ifdef __PATCH_NO_UNROLLING
   uint32_t i;
   for (i = 0; i < 512; i++) {
      HWREG(RFC_MCERAM_BASE + 4 * i) = patchTofMce[i];
   }
#else
   const uint32_t *pS = patchTofMce;
   volatile unsigned long *pD = &HWREG(RFC_MCERAM_BASE);
   uint32_t t1, t2, t3, t4, t5, t6, t7, t8;
   uint32_t nIterations = 64;

   do {
      t1 = *pS++;
      t2 = *pS++;
      t3 = *pS++;
      t4 = *pS++;
      t5 = *pS++;
      t6 = *pS++;
      t7 = *pS++;
      t8 = *pS++;
      *pD++ = t1;
      *pD++ = t2;
      *pD++ = t3;
      *pD++ = t4;
      *pD++ = t5;
      *pD++ = t6;
      *pD++ = t7;
      *pD++ = t8;
   } while (--nIterations);
#endif
}

#endif
